# System Design социальной сети для курса по System Design

## Функциональные требования:
- **Публикация постов из путешествий с фотографиями, небольшим описанием и привязкой к конкретному месту путешествия:**
  - 512 символов на описание,
  - до 5 фотографий на 1 пост;
- **Оценка и комментарии постов других путешественников:**
  - до 128 символов на комментарий,
  - до 5 фото к комментарию;
- **Подписка на других путешественников, чтобы следить за их активностью:**
  - максимум можно подписаться на 500 людей;
- **Поиск популярных мест для путешествий и просмотр постов с этих мест в виде ТОПа мест по странам и городам:**
  - до 64 символов на текст для поиска;
- **Общаться с другими путешественниками в личных сообщениях:**
  - до 1024 символов на одно личное сообщение,
  - до 10 фотографий в одном личном сообщении,
  - возможность просмотреть всю историю сообщений;
- **Просматривать ленту других путешественников:**
  - возможность просмотреть всю историю ленты путешественника;
---
## Нефункциональные требования:
- DAU 10 000 000;
- Запуск только в СНГ;
- Работает онлайн из браузера и мобильных устройств;
- Availability 99.99%;
- Latency <= 1 сек на поиск популярных мест/прогрузку ленты других путешественников;
- Latency на запись комментария, поста < 2сек;
- Realtime переписка в личных сообщениях;
- Действия пользователя в день на запись [POST] (средние значения):
  - 1 пост в неделю = 0.14 постов в день,
  - подписывается на 1 пользователя в неделю = 0.14 в день,
  - 5 комментариев к постам,
  - личная переписка с 3-мя пользователями:
    - по 30 сообщений каждому;
  - лайкает 50 постов;
- Действия пользователя в день на чтение [GET] (средние значения):
  - пролистывает 200 сообщений,
  - ищет 3 места через поиск,
  - чтение комментариев 200 штук,
  - просматривает 200 постов в ленте;
- Данные хранятся всегда;
- Количество комментариев неограничено;
---
## Сущности:
#### _[POST] Пост: 2 101 168 B = 2 MB_
- ID поста: 8 B
- ID пользователя: 8 B
- ФИО пользователя: 128 B
- Аватарка пользователя: 100 KB
- Текст поста: 512 символа * 2 B = 1 024 B
- Массив фотографий: 5 фото * 400 KB = 2 000 KB

#### _[GET] Посты в ленте/фильтрации: 4 128 B = 4 KB_
- ID поста: 8 B
- ID автора: 8 B
- Ссылка на аватар автора: 256 * 2 B = 512 B
- Текст поста: 512 символа * 2 B = 1 024 B
- Массив ссылок на фотографии: 5 ссылок * 256 символов * 2 B = 2 560 B
- Счетчик лайков: 4 символа * 2 B = 8 B
- Счетчик лайков: 4 символа * 2 B = 8 B

#### _[POST] Комментарий: 1 200 280 B = 1.2 MB_
- ID комментария: 8 B
- ID поста: 8 B
- ID пользователя: 8 B
- Текст комментария: 128 символа * 2 B = 256 B
- Массив фото: 3 фото * 400 KB = 1 200 KB

#### _[GET] Комментарий: 3 344 B = 3 KB_
- ID комментария: 8 B
- ID поста: 8 B
- ID пользователя: 8 B
- Ссылка на аватар автора: 256 * 2 B = 512 B
- Текст комментария: 128 символа * 2 B = 256 B
- Массив ссылок на фотографии: 5 ссылок * 256 символов * 2 B = 2 560 B

#### _[POST] Личное сообщение: 4 002 064 B = 4 MB_
- ID пользователя_1: 8 B
- ID пользователя_2: 8 B
- Текст сообщения: 1024 символа * 2 B = 2 048 B
- Фото в сообщении: 10 * 400 KB = 4 000 KB

#### _[GET] Личное сообщение: 7 176 B = 7 KB_
- ID пользователя: 8 B
- Текст сообщения: 1024 символа * 2 B = 2 048 B
- Массив ссылок на фотографии: 10 ссылок * 256 символов * 2 B = 5 120 B

#### _Фильтр на поиск ТОП мест: 128 B_
- Текст запроса: 64 символа * 2 B = 128 B

#### _Лайк: 24 B_
- ID лайка: 8 B
- ID пользователя: 8 B
- ID поста: 8 B

#### _Подписка: 24 B_
- ID подписки: 8 B
- ID подписчика: 8 B
- ID путешественника: 8 B
---
## Расчеты:
```
WRITE User traffic per day = 
Посты(0.14) * 2 MB + 
Подписка(0.14) * 24 B + 
Комментарии(5) * 1.2 MB + 
Личные сообщения(3 * 30) * 4 MB + 
Лайки(50) * 24 B = 0.28 MB + 3.36 B + 6 MB + 360 MB + 1 200 B = 360 MB;

READ User traffic per day = 
Личное сообщения(200) * 7 KB + 
Поиск мест(3) * 128 B + 
Чтение комментариев(200) * 3 KB + 
Просмотр постов(200) * 4 KB = 1 400 KB + 384 B + 600KB + 800 KB = 2.8 MB;

User requests per day = 0.14 + 0.14 + 5 + 90 + 50 + 200 + 3 + 200 + 200 = 750;

RPS = DAU(10 000 000) * 750 / 86 400 = 86 805;

WRITE Users traffic per day = DAU(10 000 000) * 360 MB = 3 600 TB/day;
WRITE Users traffic per second = 3 600 TB / 86 400 = 41 GB/sec;

READ Users traffic per day = DAU(10 000 000) * 2.8 MB = 28 000 000 MB = 28 000 GB = 28 TB;
READ Users traffic ped second = 28 TB / 86 400 = 324 MB/sec;
```
